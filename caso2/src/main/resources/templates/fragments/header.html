<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">
<body>
    <header th:fragment="header" class="bg-primary text-white py-3 shadow">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h3 class="mb-0">
                        <i class="bi bi-mortarboard-fill"></i> Plataforma Académica
                    </h3>
                </div>
                <nav>
                    <ul class="nav">
                        <li class="nav-item">
                            <a class="nav-link text-white" th:href="@{/Home}">
                                <i class="bi bi-house-fill"></i> Inicio
                            </a>
                        </li>
                        
                        <!-- Menú para ADMIN -->
                        <li class="nav-item" sec:authorize="hasRole('ADMIN')">
                            <a class="nav-link text-white" th:href="@{/usuarios}">
                                <i class="bi bi-people-fill"></i> Usuarios
                            </a>
                        </li>
                        <li class="nav-item" sec:authorize="hasRole('ADMIN')">
                            <a class="nav-link text-white" th:href="@{/roles}">
                                <i class="bi bi-shield-fill"></i> Roles
                            </a>
                        </li>
                        
                        <!-- Menú para ADMIN y PROFESOR -->
                        <li class="nav-item" sec:authorize="hasAnyRole('ADMIN', 'PROFESOR')">
                            <a class="nav-link text-white" th:href="@{/reportes}">
                                <i class="bi bi-bar-chart-fill"></i> Reportes
                            </a>
                        </li>
                        <li class="nav-item" sec:authorize="hasAnyRole('ADMIN', 'PROFESOR')">
                            <a class="nav-link text-white" th:href="@{/consultas}">
                                <i class="bi bi-search"></i> Consultas
                            </a>
                        </li>
                        
                        <!-- Perfil para usuarios autenticados -->
                        <li class="nav-item" sec:authorize="isAuthenticated()">
                            <a class="nav-link text-white" th:href="@{/usuarios/perfil}">
                                <i class="bi bi-person-circle"></i> Mi Perfil
                            </a>
                        </li>
                        
                        <!-- Login/Logout -->
                        <li class="nav-item" sec:authorize="!isAuthenticated()">
                            <a class="nav-link text-white" th:href="@{/login}">
                                <i class="bi bi-box-arrow-in-right"></i> Iniciar Sesión
                            </a>
                        </li>
                        <li class="nav-item" sec:authorize="isAuthenticated()">
                            <form th:action="@{/logout}" method="post" class="d-inline">
                                <button type="submit" class="btn btn-link nav-link text-white text-decoration-none">
                                    <i class="bi bi-box-arrow-right"></i> Cerrar Sesión
                                </button>
                            </form>
                        </li>
                    </ul>
                </nav>
            </div>
            
            <!-- Mostrar usuario actual -->
            <div sec:authorize="isAuthenticated()" class="mt-2">
                <small>
                    Usuario: <strong sec:authentication="name"></strong> | 
                    Rol: <strong sec:authentication="principal.authorities"></strong>
                </small>
            </div>
        </div>
    </header>
</body>
</html>